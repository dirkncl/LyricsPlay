<html>
   <!-- 
     Belajar dan belajar muli dari yang sederhana, namun semakin belajar semakin banyak yang tidak tahu.
     Learn and learn from small things. The more we learn, the more we don't know. 
     Dirk L. Nicolaas - Sulawesi Utara - Indonesia
   -->
  <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="dirkncl.github.com, mp3 lyrics player ditampilkan di halaman web maupun mobile">
  <meta name="keywords" content="mp3, mp3 player, lyrics, Manado, Jakarta">
  <meta name="author" content="Dirk L. Nicolaas - Sulawesi Utara - Indonesia">
  <script type="text/javascript">var VOLUME0='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 1200"><path d="M1089.041 681.36c1.719 1.718 2.577 3.742 2.577 6.074 0 2.331-.858 4.356-2.577 6.074l-57.063 57.063c-1.718 1.718-3.681 2.577-5.89 2.577-1.964 0-4.05-.859-6.259-2.577l-81.359-81.36-81.36 81.36c-1.718 1.718-3.682 2.577-5.891 2.577-1.964 0-4.05-.859-6.259-2.577l-57.063-57.063c-1.473-1.473-2.209-3.559-2.209-6.259 0-2.454.736-4.417 2.209-5.89l81.36-81.36-80.992-81.36c-1.718-1.473-2.577-3.436-2.577-5.89 0-2.7.859-4.786 2.577-6.259l56.694-57.063c1.719-1.718 3.805-2.577 6.259-2.577s4.418.859 5.891 2.577l81.36 81.36 81.359-81.36c1.718-1.718 3.743-2.577 6.074-2.577 2.332 0 4.356.859 6.074 2.577l57.063 57.063c1.719 1.718 2.577 3.743 2.577 6.074 0 2.332-.858 4.356-2.577 6.074L1007.682 600l81.359 81.36zm-980.66-296.554h243.817l366.784-298.94v1028.27l-366.784-298.94H108.381v-430.39z" style="fill: black;"/></svg>';var VOLUME='<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 1200"><path d="M0 384.806h243.816L610.6 85.866v1028.269l-366.784-298.94H0V384.806zm748.41-48.764c72.085 72.084 108.834 159.717 110.247 262.897 0 98.94-36.749 183.746-110.247 254.418l-74.205-76.325c50.883-50.884 76.325-110.954 76.325-180.212 0-70.672-25.442-132.156-76.325-184.453l74.205-76.325zm127.208-125.088c106.008 106.007 159.011 233.922 159.011 383.745 0 149.824-53.003 278.445-159.011 385.866l-78.445-78.445c84.806-83.393 127.209-185.513 127.209-306.36s-42.403-223.675-127.208-308.48l78.444-76.326zM992.227 94.346c65.018 65.018 115.9 140.636 152.649 226.855 36.749 86.22 55.124 177.386 55.124 273.498 0 96.113-18.375 187.633-55.124 274.559s-87.632 162.897-152.649 227.916l-76.325-76.326c117.314-117.314 175.972-259.01 175.972-425.088s-58.657-307.774-175.972-425.088l76.325-76.326z"  style="fill: black;"/></svg>';/*Dirk L. Nicolaas - Sulawesi Utara - Indonesia*/window.LyricsMP3Player = function (options) {this.id = "lyricDisplay";this.currentStyle = "currentLne";this.prefixLinId = "lyrics-line";this.showLines = 4;this.clickable = true;this.clickEventName = "LyricToClick";if( options ) {for( var prop in options ) {if ( typeof this[prop] != "undefined" && options.hasOwnProperty(prop)) {this[prop] =  options[prop];}}};this.setLrc = function(rawLrc) {this.tags = {};this.lrc = [];this.rangeLrc = [];var tagRegex = /\[([a-z]+):(.*)\].*/;var lrcAllRegex = /(\[[0-9.:\[\]]*\])+(.*)/;var timeRegex = /\[([0-9]+):([0-9.]+)\]/;var rawLrcArray = rawLrc.split(/[\r\n]/);for (var i = 0; i < rawLrcArray.length; i++) {var tag = tagRegex.exec(rawLrcArray[i]);if ( tag && tag[0] ) {this.tags[tag[1]] = tag[2];continue;};var lrc = lrcAllRegex.exec(rawLrcArray[i]);if ( lrc && lrc[0] ) {var times = lrc[1].replace(/\]\[/g,"],[").split(",");for (var j = 0; j < times.length; j++) {var time = timeRegex.exec(times[j]);if ( time && time[0] ) {this.lrc.push( { "starttime": parseInt(time[1],10) * 60 + parseFloat(time[2]), "line": lrc[2] } );};};};};this.lrc.sort(function (a,b) {  return a.starttime - b.starttime;});for (var i = 0; i < this.showLines; i++) {this.rangeLrc.push( { "starttime": -1, "endtime": 0, "line": "&nbsp;" } );};var starttime = 0;var line = "";for (var i = 0; i < this.lrc.length; i++) {endtime =  parseFloat(this.lrc[i].starttime);this.rangeLrc.push( { "starttime": starttime, "endtime": endtime, "line": line } );starttime = endtime;line = this.lrc[i].line;};this.rangeLrc.push( { "starttime": starttime, "endtime": 999.99, "line": line } );for (var i = 0; i < this.showLines; i++) {this.rangeLrc.push( { "starttime": -1, "endtime": 0, "line": "&nbsp;" } );};this.totalLines = this.rangeLrc.length;this.currentLine = 0;var container = document.getElementById(this.id);container.innerHTML = "";var ul = document.createElement("ul");container.appendChild(ul);for (var i = 0; i < this.totalLines; i++) {var li = document.createElement("li");li.innerHTML = this.rangeLrc[i].line;if (!li.innerHTML) {li.innerHTML="&nbsp;"};li.setAttribute("id", this.prefixLinId + i);if (this.clickable) {li.onclick = lineClicked(this, i);li.style.cursor = 'pointer';};ul.appendChild(li);};for (var i = this.showLines; i < this.totalLines; i++) {document.getElementById(this.prefixLinId + i).style.display = "none";};this.move(0);};var lineClicked = function(self, id) {return function(){var detail = {"time": self.rangeLrc[id].starttime};var e = new CustomEvent(self.clickEventName, {'detail': detail,'bubbles': true});var elem = document.getElementById(self.prefixLinId + id);elem.dispatchEvent(e);};};this.move = function(time) {for (var i = 0; i < this.totalLines; i++) {if (time >= this.rangeLrc[i].starttime && time < this.rangeLrc[i].endtime) {this.currentLine = i;var startShow = this.currentLine - this.showLines;var endShow = this.currentLine + this.showLines;for (var i = 0; i < this.totalLines; i++) {var li = document.getElementById(this.prefixLinId + i);if ( i >= startShow && i <= endShow ) {li.style.display = "block";}else{li.style.display = "none";};if (i==this.currentLine) {li.className = this.currentStyle;} else {li.className = "";};};return;};};};};function getLyric(url) {var that = this,request = new XMLHttpRequest();request.open('GET', url, true);request.responseType = 'text';request.onload = function() {var text=(request.response).split('\n').join('\n');var audio = document.getElementById("player");var lrc = new LyricsMP3Player();lrc.setLrc(text);audio.addEventListener("timeupdate", function() {lrc.move(audio.currentTime);});window.addEventListener('LyricToClick', function(e){if (e.detail.time > 0) {audio.currentTime = e.detail.time;}});};request.onerror = request.onabort = function(e) {console.log('lyric fail');};console.log('loading...');request.send();};var playStatus = false;var Mobile = /Android|webOS|iPhone|iPad|iPod/i.test(navigator.userAgent);window.onload = function(){var audio = document.getElementById("player");var volumesvg=document.getElementById("VolumeSVG");var chg_vol=document.getElementById("VolumeValue");volumesvg.innerHTML=VOLUME;var play = document.getElementById('play');var pause = document.getElementById('pause');var bar = document.getElementById('bar');playStatus=true;play.innerHTML="&#10074;&#10074;";function displayControls() {play.style.display = "block";};if (audio.paused) {displayControls();}else {audio.addEventListener('canplay', function() {displayControls();});};function togglePlay() {if (playStatus) {audio.pause();play.innerHTML="&#9658;";playStatus= false;}else {audio.play();play.innerHTML="&#10074;&#10074;";playStatus = true;}};play.addEventListener('click', togglePlay,false);audio.addEventListener('timeupdate', function() {bar.innerHTML = parseInt(audio.currentTime/60)%60+':'+parseInt(audio.currentTime)%60+' / '+parseInt(audio.duration/60)%60+':'+parseInt(audio.duration%60);bar.title = 'Running Time';});function VolumeValue(){audio.volume=document.getElementById("VolumeValue").value/100;if(audio.volume==0) document.getElementById("VolumeSVG").innerHTML=VOLUME0;if(audio.volume!=0) document.getElementById("VolumeSVG").innerHTML=VOLUME;}function toggle_vol(){if(chg_vol.value!='0'){chg_vol.value='0';VolumeValue();volumesvg.innerHTML=VOLUME0;}else if(chg_vol.value=='0'){chg_vol.value='100';VolumeValue();volumesvg.innerHTML=VOLUME}};chg_vol.addEventListener('click', VolumeValue,false);VolumeSVG.addEventListener('click', toggle_vol,false);window.M3U={};var fileM3u=document.URL;fileM3u = fileM3u.replace(/#.*/,"");fileM3u=fileM3u.substring(0,fileM3u.length-4)+"m3u";parser = function(m3uData){Data=m3uData.replace(/\r/g,"");return (Data.substr(0,Data.search("\n"))==="#EXTM3U"?Data.substr(Data.search("\n")).split("\n#").filter(function(a){return!!a.trim().length}).map(function(e){var c;return (c=e.match(/:(?:(-?\d+),(.+)\s*-\s*(.+)|(.+))\n(.+)/),c&&6===c.length?{length: c[1]||0,artist: c[2]||"",title:  c[4]||c[3],file:c[5].trim()}:void 0)}):Data.split("\n").filter(function(e){return!!e.trim().length}).filter(function(e){return"#"!==e[0]}).map(function(e){return {file:e.trim()}}))},window.M3U={name:"m3u",parse:parser};var playlist;var xhr = new XMLHttpRequest();xhr.open("GET", fileM3u);xhr.overrideMimeType("audio/x-mpegurl");xhr.onload = parse;xhr.send();function parse () {playlist = M3U.parse(this.response);var options =document.getElementById("musicSelector");for (var i = 0; i < playlist.length; i++){var option = document.createElement("option");option.text = playlist[i].title;option.value = playlist[i].file;options.add(option);}};function change(url, name) {var source = document.getElementById("mp3_source");if (url != "none") {audio.pause();document.title = name;source.src = url;getLyric(url.replace('.mp3','.lrc'));audio.load();audio.play();}};document.getElementById('musicSelector').addEventListener('change', function() {change((this).value, playlist[(this).selectedIndex-1].title);},false);function domElement(){var drag=document.createElement('style');drag.textContent='#lyricDisplay {font-size: 100%;font-family: "Arial";text-shadow: 0 0 1px #EEEEEE;color: #006666;overflow: hidden;}#lyricDisplay ul {list-style-type: none;padding: 5px;}#lyricDisplay ul li {overflow: hidden;}#lyricDisplay ul li:hover {color: #428bca;}#lyricDisplay .currentLne {color: blue;font-size: 30px;text-shadow: 0 0 1px #fff, 0 0 2px #fff, 0 0 3px #fff, 0 0 4px #ffffaa, 0 0 6px #ffffaa, 0 0 8px #ffffaa, 0 0 10px #ffffaa, 0 0 12px #ffffaa;}#MP3Lyrics {position: absolute; z-index: 90; background-color: white;border: 1px solid #d3d3d3;text-align: center;}#MP3LyricsHolder {padding: 10px; cursor: move; z-index: 91; background-color: #fce997; color: #fff;width:400px;overflow: auto}input[type=range] {-webkit-appearance: none;margin: 10px 0;width: 40%;}input[type=range]:focus {outline: none;}input[type=range]::-webkit-slider-runnable-track {width: 40%;height: 4px;cursor: pointer;animate: 0.2s;box-shadow: 0px 0px 0px #000000, 0px 0px 0px #0d0d0d; background: gray;border-radius: 5px;border: 0px solid #000101;}input[type=range]::-webkit-slider-thumb {box-shadow: 0px 0px 0px #000000, 0px 0px 0px #0d0d0d;border: 0px solid #000000;height: 10px;width: 4px;border-radius: 3px;background: gray;cursor: pointer;-webkit-appearance: none;margin-top: -3px;}input[type=range]:focus::-webkit-slider-runnable-track {background: gray;}#main{background:white;}#play{width: 2px;float: left;margin-top: 0px;cursor: pointer;}#progress {width: 60px;float: left;margin-left: 18px;margin-top: 5px;}#bar {height: 5px;margin-top: -3px;font-size:12}#VolumeSVG{position:absolute;height:15px;width: 15px;float: left;margin-left:90px;cursor: pointer;}#VolumeValue{width: 60px;margin-top:5px;float: left;margin-left:40px;cursor: pointer;}#musicSelector{border: 0px;}';document.head.appendChild(drag);};function dragElement(elmnt) {console.log(Mobile);var pos1 = 0, pos2 = 0, pos3 = 0, pos4 = 0;if (document.getElementById(elmnt.id + "Holder")) {Mobile?document.getElementById(elmnt.id + "Holder").ontouchstart = dragMouseDown:document.getElementById(elmnt.id + "Holder").onmousedown = dragMouseDown;}else {Mobile?elmnt.ontouchstart = dragMouseDown:elmnt.onmousedown = dragMouseDown;}function dragMouseDown(e) {e = e || window.event;e.preventDefault();pos3 = e.clientX;pos4 = e.clientY;Mobile?(document.ontouchend = closeDragElement, document.ontouchmove = elementDrag):(document.onmouseup = closeDragElement, document.onmousemove = elementDrag)}function elementDrag(e) {e = e || window.event;e.preventDefault();pos1 = pos3 - e.clientX;pos2 = pos4 - e.clientY;pos3 = e.clientX;pos4 = e.clientY;elmnt.style.top = (elmnt.offsetTop - pos2) + "px";elmnt.style.left = (elmnt.offsetLeft - pos1) + "px";}/*Dirk L. Nicolaas - Sulawesi Utara - Indonesia*/function closeDragElement() {Mobile?(document.ontouchend = null, document.ontouchmove = null):(document.onmouseup = null, document.onmousemove = null)}};domElement();dragElement(document.getElementById("MP3Lyrics"));}</script>
  </head>
  <body><marquee><a href='https://github.com/dirkncl/LyricsPlay/'>MP3 Lirik Player by Dirk L. Nicolaas</a></marquee>
  </body>
  <script>document.write('<div id="MP3Lyrics"><div id="MP3LyricsHolder"><div id="lyricDisplay"><\/div></div><audio id="player" controls auto style="display:none"><source id="mp3_source"><\/audio><div id="lyricsContainer"><\/div><hr><\/hr><select id="musicSelector"><option value="">- mp3 Selector -<\/option></select><div id="main"><play id="play" style="display:"><\/play><div id="progress"><div id="bar"><\/div><\/div><div id="VolumeSVG"><\/div><input type="range" id="VolumeValue"  step="0" min="0" max="100" value="50"><\/div><\/div>');</script>
</html>